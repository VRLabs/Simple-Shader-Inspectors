<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Using IControlContainer | Simple Shader Inspectors Documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Using IControlContainer | Simple Shader Inspectors Documentation ">
    <meta name="generator" content="docfx 2.57.2.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="png" src="../../logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="cdev-IControlContainer">
<h1 id="using-icontrolcontainer">Using IControlContainer</h1>

<p>Sometimes you may want to have a control being able to manage additional controls under it, for example you want a control that will show another control if its property value is above a certain threshold.</p>
<p>This would technically be possible by just checking the value change in the inspector and enabling/disabling the controls that should be affected, but that requires to write code to handle that for every occasion, and we want it to be automatic.</p>
<p>To do that we will need to use the IControlContainer interface.</p>
<p>Let's take our custom control template and implement the IControlContainer interface:</p>
<pre><code class="lang-csharp" name="Main">using System.Collections.Generic;
using UnityEditor;
using VRLabs.SimpleShaderInspectors;

namespace TestControlNamespace
{
    public class MyCustomControl : PropertyControl, IControlContainer
    {
        public MyCustomControl(string propertyName) : base(propertyName)
        {
        }

        protected override void ControlGUI(MaterialEditor materialEditor)
        {
        }

        public void AddControl(SimpleControl control)
        {
        }

        public IEnumerable&lt;SimpleControl&gt; GetControlList()
        {
        }
    }
}
</code></pre>
<p>The implement the interface you need to implement the <code>AddControl</code> and <code>GetControlList</code> methods in you class.</p>
<p>The first method is generally used in the generated chainable methods to add a new control under this one, meanwhile the second one is used when the inspector fetches properties.</p>
<p>How you store those controls is up to you, in this case we will use a list.</p>
<p>And in the meantime, we also add a simple range property and get the control to do something:</p>
<pre><code class="lang-csharp" name="Main" highlight-lines="9,13,18-20,23,25">using System.Collections.Generic;
using UnityEditor;
using VRLabs.SimpleShaderInspectors;

namespace TestControlNamespace
{
    public class MyCustomControl : PropertyControl, IControlContainer
    {
        public List&lt;SimpleControl&gt; Controls { get; set; }

        public MyCustomControl(string propertyName) : base(propertyName)
        {
            Controls = new List&lt;SimpleControl&gt;();
        }

        protected override void ControlGUI(MaterialEditor materialEditor)
        {
            EditorGUI.BeginChangeCheck();
            materialEditor.RangeProperty(Property, Content.text);
            HasPropertyUpdated = EditorGUI.EndChangeCheck();
        }

        public void AddControl(SimpleControl control) =&gt; Controls.Add(control);

        public IEnumerable&lt;SimpleControl&gt; GetControlList() =&gt; Controls;
    }
}
</code></pre>
<p>Only notable mentions are the 2 methods implementation being done in an unusual way, this is for the most part just a &quot;shortcut&quot; that can be done when the method implementation consist in only one operation (if you're not confortable with it, you can just write it like you're used to, the result is the same).
Also the <code>RangeProperty</code> method for some reason doesn't have an overload that accepts a <code>GUIContent</code>, so we had to pass just the <code>text</code> string of it (unity pls fix this thanks).</p>
<p>Now our control properly displays any float property that is being given to it, but if you add any control to this one they will simply not display, that's cause it's our responsibility to handle that:</p>
<pre><code class="lang-csharp" name="Main" highlight-lines="3-9">    materialEditor.RangeProperty(Property, Content.text);
    HasPropertyUpdated = EditorGUI.EndChangeCheck();
    if (Property.floatValue &gt; 0.5f)
    {
        foreach (SimpleControl control in Controls)
        {
            control.DrawControl(materialEditor);
        }
    }
}
</code></pre>
<p>We first check if the property has its value above <code>0.5</code> and cycle all controls inside our list to draw them.</p>
<p>If you try to move the slider around you will see that other controls added to this control will show up as soon as you surpass <code>0.5</code>.</p>
<div class="TIP">
<h5>Tip</h5>
<p>As you probably noticed, we use the <code>DrawControl</code> method to display a control's content, but we usually override <code>ControlGUI</code> when deciding what to display in our controls. This is cause <code>DrawControl</code> internally calls <code>ControlGUI</code>, but it also does additional checks, like checking if the control should be visible to begin with, or if should be in a disabled state.</p>
</div>
<h2 id="finished-example-class">Finished example class</h2>
<pre><code class="lang-csharp" name="Main">using System.Collections.Generic;
using UnityEditor;
using VRLabs.SimpleShaderInspectors;

namespace TestControlNamespace
{
    public class MyCustomControl : PropertyControl, IControlContainer
    {
        public List&lt;SimpleControl&gt; Controls { get; set; }

        public MyCustomControl(string propertyName) : base(propertyName)
        {
            Controls = new List&lt;SimpleControl&gt;();
        }

        protected override void ControlGUI(MaterialEditor materialEditor)
        {
            EditorGUI.BeginChangeCheck();
            materialEditor.RangeProperty(Property, Content.text);
            HasPropertyUpdated = EditorGUI.EndChangeCheck();
            if (Property.floatValue &gt; 0.5f)
            {
                foreach (SimpleControl control in Controls)
                {
                    control.DrawControl(materialEditor);
                }
            }
        }

        public void AddControl(SimpleControl control) =&gt; Controls.Add(control);

        public IEnumerable&lt;SimpleControl&gt; GetControlList() =&gt; Controls;
    }
}
</code></pre></article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/VRLabs/SimpleShaderInspectors/blob/master/docsOutput/docs/guides/ControlsDevelopment/IControlContainer.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Copyright © VRLabs.<br>Generated by <strong>DocFX</strong></span>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
